\chapter{mcmcreg objects}
\label{mcmcreg} \index{mcmcreg object}



{\em mcmcreg objects} are used to fit Bayesian quantile regression and (multivariate) distributional regression models with {\em
structured additive predictor}, see \citeasnoun{kleknelan14a}. Hierarchical data structures may be considered using
hierarchical or multilevel structured additive predictors. For multilevel structured additive models  see
\citeasnoun{LanUml14}. Inference is based on a fully Bayesian approach implemented via Markov Chain Monte Carlo (MCMC)
simulation techniques. The methodology manual provides a brief introduction to (multilevel) structured additive regression and MCMC-based
inference. More details can be found in the references cited above and in the book by \citeasnoun{fahkne13}.

%First steps with {\em mcmcreg objects} can be done with the
%tutorial like example in chapter ?? of the
%tutorials manual which provides a self-contained demonstrating
%example.


\clearpage

\section{Method hregress}
\label{mcmcregress} \index{mcmcreg object!hregress
function}\index{hregress function}

\subsection{Description}
\label{mcmcregregressdescr}

Method #hregress# estimates (hierarchical) distributional structured additive regression models.

\index{Generalized linear models} \index{Generalized additive
models} \index{Varying coefficients} \index{Bayesian semiparametric
regression} \index{MCMC} \index{Markov chain Monte Carlo}
\index{Distributional regression}

\subsection{Syntax}
\index{Regression syntax}\index{mcmcreg object!Regression syntax}
\label{mcmcregregresssyntax}

 #> #{\em objectname}.#hregress# {\em model} [#weight# {\em weightvar}] [#if# {\em expression}] [{\em , options}] #using# {\em dataset}

Method #hregress# estimates the regression model specified in {\em
model} using the data specified in {\em dataset}. {\em dataset}
has to be the name of a {\em dataset object} created before. The
details of correct models are covered in \autoref{mcmcregmodelsyntax}.
The distribution of the response variable can be chosen from a wide
range of uni- and multivariate distributions. It is
specified using options
#family# and #equationtype#, see \autoref{mcmcregfamilysyntax} below and the options list in
\autoref{mcmcregregressoptions}. The default value is #family=gaussian# and #equationtype=mu#
with an identity link.  An #if# statement may be specified to analyze
only parts of the data set, i.e.~the observations where {\em
expression} is true.

\subsubsection{Optional weight variable}\index{Weighted regression}
\label{weightspecification}

An optional weight variable {\em weightvar} may be specified to
estimate weighted regression models.


%For Gaussian responses {\em
%BayesX} assumes that $y_r|\eta_r,\sigma^2 \sim
%N(\eta,\sigma^2/weightvar_r)$. Thus, for grouped Gaussian
%responses the weights must be the number of observations in the
%groups if the $y_r$'s are the average of individual responses. If
%the $y_r$'s are the sum of responses in every group, the weights
%have to be the reciprocal of the number of observations in the
%groups. Of course, estimation of usual weighted regression models
%with heteroscedastic errors is also possible. In this case the
%weights should be proportional to the reciprocal of the
%heteroscedastic variances. If the response distribution is
%binomial, it is assumed that the values of the weight variable
%correspond to the number of replications and that the values of
%the response variable itself correspond to the number of
%successes. If #weight# is omitted, {\em BayesX} assumes that the
%number of replications is one, i.e.~the values of the response
%must be either zero or one. For grouped Poisson data the weights
%have to be the number of observations in a group and the $y_i$'s
%are assumed to be the average of individual responses. In the case
%of gamma distributed responses, {\em BayesX} assumes $y_r \sim
%G(\exp(\eta_r),\nu/weightvar_r)$ where $\mu_r= \exp(\eta_r)$ is
%the mean and $s_r = \nu/weightvar_r$ is the scale parameter.
%
%If estimation is based on latent utility representations, the
%specification of weights is not allowed. Similarly, for negative
%binomial, zero inflated Poisson and zero inflated negative
%binomial models as well as hazard regression and multi-state
%models, weighted regression is not implemented yet.

\subsubsection{Syntax of possible model terms}
\label{mcmcregmodelsyntax}\index{Model terms}\index{mcmcreg object!Model
terms}

The general syntax of models is:

$depvar = term_1 + term_2 + \cdots + term_r$

where {\em depvar} specifies the dependent variable in the model
and $term_1$,\dots,$term_r$ define the specific form of covariate
effects on the dependent variable. The different terms have to be
separated by '+' signs. A constant intercept is (in contrast to
{\em bayesreg objects}) NOT automatically
included in the models and must be specified by the
analyst using the term #const#. This section reviews all possible model terms that are
currently supported by {\em mcmcreg objects} and provides some
specific examples. Note that all described terms may be combined
in arbitrary order. An overview about the capabilities of {\em
mcmcreg objects} is given in \autoref{mcmcterms}.
\autoref{mcmcreginteractions} shows how interactions between
covariates are specified. Full details about all available options
are given in \autoref{mcmclocaloptions}.

Throughout this section, #Y# will denote the dependent variable.

\subsubsection*{Offset}\index{Offset}

\begin{itemize}
\item[] {\em Description}: Adds an offset term to the predictor.
\item[] {\em Predictor}: $\eta =  \cdots + \mbox{\it offs} + \cdots$
\item[] {\em Syntax}: #offs(offset)#
\item[] {\em Example}:

The following model statement can be used to estimate a Poisson
model with #offs# as offset term and #W1# and #W2# as fixed
effects (if #family=poisson# is specified in addition):

#Y = offs(offset) + W1 + W2#

Note that the offset variable is included on the level of the predictor.
\end{itemize}

\subsubsection*{Fixed effects}\index{Fixed effects}

\begin{itemize}
\item[] {\em Description}: Incorporates covariate #W1# as a fixed effect into the model.
\item[] {\em Predictor}: $\eta =  \cdots + \gamma_1 W1 + \cdots$
\item[] {\em Syntax}: #W1#
\item[] {\em Example}:

The following model statement specifies a model with $q$ fixed
(linear) effects and an intercept:

\texttt{Y = const + W1 + W2 + $\cdots$ + Wq}
\end{itemize}

% NEW_START: Susanne.Konrath@stat.uni-muenchen.de %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsubsection*{Shrinkage of fixed effects}
\index{Shrinkage of fixed Effects}


\begin{itemize}
\item[] {\em Description}: Defines a shrinkage prior for the corresponding
  parameters $\gamma _{j} $, $j=1,\ldots,q$, $q \ge 1$ of the linear effects
  #X1#,\ldots,#Xq#. There are two priors possible: ridge and
  lasso type priors.

\item[] {\em Predictor}: $\eta =\cdots +\gamma _{1} {\kern 1pt} X1+\cdots +
  \gamma _{q} {\kern 1pt} Xq+\cdots $

\item[] {\em Syntax}:

  \begin{itemize}
  \item  Ridge-prior: #X1(ridge#[, {\em options}]#) #
  \item  Lasso-prior: #X1(lasso#[, {\em options}]#) #
  \end{itemize}

\item[] {\em Example}:
 The following model statement can be used to estimate a model with $q$ lasso-penalized
 linear effects

 #Y = X1(lasso)+...+ Xq(lasso)#

 By default, the starting value of the shrinkage parameter in the Markov chain is
 set to 1 and the shrinkage parameter is estimated by the data. It is also possible
 to fix the shrinkage parameter through the iterations in order to use a prespecified
 amount of shrinkage. To do so, the option #shrinkagefix# has to be set
 in the corresponding terms and this results in fixing the shrinkage parameter at
 the starting value assigned in the option #shrinkage#.

 The following model term defines a lasso penalty with shrinkage parameter
 fixed at the value 1.5:

 #Y = X1(lasso)+...+ Xq(lasso,shrinkage=1.5,shrinkagefix)#

 Full details about all possible options for shrinkage effects are given in Section \ref{localoptions}.

 {\em Important Remark}: Except for the option #tau2# for the variances of lasso and ridge
 (and the options #I# and #t2# for nigmix),
 all the other possible options used in the shrinkage methods are those which are
 specified in the first term of the corresponding penalty, e.g.

 #Y = X2(lasso,shrinkagepar=2,shrinkagefix)+ X1(lasso,shrinkagepar=1.5)#

 uses the options of #X2#. If the option #adaptive# is specified the options from
 each term are used.
\end{itemize}

% NEW_END: Susanne.Konrath@stat.uni-muenchen.de %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


\subsubsection*{Nonlinear effects of continuous covariates and time scales}
\index{Nonlinear effects}
\index{P-splines}


\begin{itemize}
\item[] {\em Description}: Defines a P-spline with a first or
second order random walk prior for the parameters of the spline.

\item[] {\em Predictor}: $\eta =  \cdots + f_1(X1) + \cdots$

\item[] {\em Syntax}:
#X1(pspline#[{\em , options}]#) #

\item[] {\em Example}:

A P-spline with second order random walk prior is obtained by:

#Y = X1(pspline)#

By default, a second order random walk prior is used, the degree of the spline is 3 and the number of inner
knots is 20. The following model term defines a quadratic P-spline
with 30 knots and a first order random walk prior:

#Y = X1(pspline,degree=2,nrknots=30,difforder=1)#

Full details about all possible options for P-splines are given in
\autoref{mcmclocaloptions}.
\end{itemize}



\subsubsection*{Spatial Covariates}
\index{Spatial effects}
\index{Markov random fields}
%\index{Two-dimensional P-spline}

\begin{itemize}
% \item[]{\bf\sffamily Markov random field}

\item[] {\em Description}:

Defines a Markov random field prior for the spatial covariate
#region#. {\em BayesX} allows to incorporate spatial covariates
with geographical information stored in the {\em map object}
specified in option #map#.

\item[] {\em Predictor}: $\eta = \cdots + f_{spat}(region) +
\cdots$

\item[] {\em Syntax}:

#region(spatial,map=#{\em characterstring}#[#{\em , options}]#) #
\item[] {\em Example}:

For the specification of a Markov random field prior, #map# is an
obligatory argument that represents the name of a {\em map object}
(see \autoref{map}) containing all necessary spatial information
about the geographical map, i.e.~the neighbors of each region and
the weights associated with the neighbors. For example the
statement

#Y = region(spatial,map=germany)#

defines a Markov random field prior for #region# where the
geographical information is stored in the {\em map object}
#germany#. An error will be raised if #germany# is not existing.
It is advisable to reorder the regions of a map prior to
estimation of a spatial effect to obtain a band matrix like
precision matrix. This can be achieved using method #reorder# of
{\em map objects}, see \autoref{mapreorder} for details.



%\item[]{\bf\sffamily Two-dimensional P-spline with first order
%random walk penalty}
%
%\item[] {\em Description}:
%
%Defines a two-dimensional P-spline for the spatial covariate
%#region# with a two-dimensional first order random walk penalty
%for the parameters of the spline. Estimation is based on the
%coordinates of the centroids of the regions. The centroids are
%computed using the geographical information stored in the {\em map
%object} specified in the option #map#.
%
%\item[] {\em Predictor}: $\eta= \cdots + f(centroids) + \cdots$
%
%\item[] {\em Syntax}:
%
%#region(geospline,map=#{\em characterstring}#[, #{\em options}]#) #
%\item[] {\em Example}:
%
%For the specification of a two-dimensional P-spline ({\em
%geospline}) #map# is an obligatory argument indicating the name of
%a {\em map object} (see \autoref{map}) that contains all necessary
%spatial information about the geographical map, i.e.~the neighbors
%of each region and the weights associated with the neighbors. The
%model term
%
%#Y = region(geospline,map=germany)#
%
%specifies a two-dimensional cubic P-spline with first order random
%walk penalty where the geographical information is stored in the
%{\em map object} #germany#.
\end{itemize}


\subsubsection*{Unordered group indicators}
\index{Unordered group indicators}
\index{Random effects}
\index{Random intercept}

% STEFAN: MUSS SO NOCH IMPLEMENTIERT WERDEN

\begin{itemize}
%\item[]{\bf\sffamily Unit- or cluster-specific unstructured effect}
\item[] {\em Description}: Defines an unstructured (uncorrelated)
random effect with respect to grouping variable #grvar#. \item[]
{\em Predictor}: $\eta = \cdots + f(grvar) + \cdots$ \item[] {\em
Syntax}:

#grvar(random#[, {\em options}]#) #
\item[] {\em Example}:

Gaussian i.i.d.~random effects allow to cope with unobserved
heterogeneity among units or clusters of observations. Suppose the
analyzed data set contains a group indicator #grvar# that gives
information about the individual or cluster a particular
observation belongs to. Then an individual-specific uncorrelated
random effect is defined by

#Y = grvar(random)#

Note that {\em BayesX} allows the specification of hierarchical or multilevel models that go far beyond
the simple random intercept term described above, see \autoref{mcmcregmultilevelsyntax}.
\end{itemize}



\subsubsection*{Varying coefficients with continuous covariates as
effect modifier}
\index{Varying coefficients}

\begin{itemize}

\item[] {\em Description}:

Defines a varying coefficient term, where the effect of #X1#
varies smoothly over the range of #X2#. The smoothness prior for
$f(X2)$ is a P-spline with first or second order random walk
prior. \item[] {\em Predictor}: $\eta= \cdots + f(X2)X1 +
\cdots$ \item[] {\em Syntax}:

#X1*X2(pspline#[, {\em options}]#) #

\item[] {\em Example}:

A varying coefficient term with a second order random walk
smoothness prior is defined as follows:

#Y = X1*X2(pspline)#
\end{itemize}


\subsubsection*{Varying coefficients with spatial covariates as
effect modifiers}

\begin{itemize}
\item[] {\em Description}:

Defines a varying coefficients term where the effect of #X1#
varies smoothly over the range of the spatial covariate #region#.
A Markov random field is estimated for $f_{spat}($#region#$)$. The
geographical information is assumed to be stored in the {\em map
object} specified in the option #map#.

\item[] {\em Predictor}: $\eta = \cdots + f_{spat}(region)X1 +
\cdots$

\item[] {\em Syntax}:

#X1*region(spatial,map=#{\em characterstring}#[,#{\em options}]#) #
\item[] {\em Example}:

The statement

#Y = X1*region(spatial,map=germany) #

defines a varying coefficient term with the spatial covariate
#region# as the effect modifier and a Markov random field as spatial
smoothness prior. Weighted Markov random fields can be estimated by
including an appropriate weight definition when creating the {\em
map object} #germany# (see \autoref{mapinfile}).
\end{itemize}


%{\em Two-dimensional P-spline with first order random walk penalty}
%\begin{itemize}
%\item[] {\em Description}:

%Defines a varying coefficients term where the effect of X1 varies
%smoothly over the range of the spatial covariate X2. A 2
%dimensional P-spline based on the tensor product of one-dimensional
%P-splines with a two-dimensional first order random walk penalty for
%the parameters of the spline is estimated for $f$. The centroids
%are computed using the geographical information stored in the map
%object specified through the option #map#.
%\item[] {\em Predictor}: $\eta= \cdots + f(centroids)X1 + \cdots$
%\item[] {\em Syntax}:

%X1*X2(geospline,map=characterstring[, options])
%\item[] {\em Example}:
%\end{itemize}



\subsubsection*{Varying coefficients with unordered group indicators as effect modifiers
(random slopes)}
\index{Random effects}\index{Random slope}

% STEFAN: NOCH IMPLEMENTIEREN

\begin{itemize}
\item[] {\em Description}:

Defines a varying coefficient term where the effect of #X1# varies
over the range of the group indicator #grvar#. Models of this type
are usually referred to as models with random slopes. A Gaussian
i.i.d.~random effect with respect to grouping variable #grvar# is
assumed for $f(grvar)$.
\item[]{\em Syntax}:

#X1*grvar(random#[, {\em options}]#) #
\item[] {\em Example}:

A random slope  is specified as follows:

#Y = X1*grvar(random)#

Note that {\em BayesX} allows the specification of hierarchical or multilevel models that go far beyond
the simple random intercept term described above, see \autoref{mcmcregmultilevelsyntax}.
\end{itemize}


\subsubsection*{Surface estimators}\index{Surface
estimators}\index{Two-dimensional P-spline}\index{Kriging}

\begin{itemize}
\item[] {\bf\sffamily Two-dimensional kriging term}

\item[] {\em Description}:

Defines a two dimensional Gaussian field (kriging term)

\item[] {\em Predictor}: $\eta= \cdots + f(X1,X2) + \cdots$
\item[] {\em Syntax}:

#X1*X2(kriging#[, {\em further options}]#) #
\item[] {\em Example}:

The model term

#Y = X1*X2(kriging)#

specifies a two-dimensional Gaussian field.



%\item[] {\bf\sffamily Two-dimensional P-spline with first order
%random walk penalty}
%
%\item[] {\em Description}:
%
%Defines a two-dimensional P-spline with a two-dimensional first
%order random walk penalty for the parameters of the spline.
%\item[] {\em Predictor}: $\eta= \cdots + f(X1,X2) + \cdots$
%\item[] {\em Syntax}:
%
%#X1*X2(pspline2dimrw1#[, {\em options}]#) #
%\item[] {\em Example}:
%
%The model term
%
%#Y = X1*X2(pspline2dimrw1)#
%
%specifies a two-dimensional cubic P-spline with first order random
%walk penalty.
%
%In many applications it is favorable to additionally incorporate
%the one-dimensional main effects of #X1# and #X2# into the model.
%In this case the two-dimensional surface can be seen as the
%deviation from the main effects. Note, that the number of inner
%knots has to be the same for the main effects and the interaction
%effect. For example, splines with 10 inner knots are estimated by
%
%
% #Y = X1(psplinerw2,nrknots=10) + X2(psplinerw2,nrknots=10)#\\
% #    + X1*X2(pspline2dimrw1,nrknots=10)#
\end{itemize}



\subsubsection{Description of additional options for terms of mcmcreg objects}
\label{mcmclocaloptions}

All arguments described in this section are optional and can
therefore be omitted. Generally, all options are specified by
adding the option name to the specification of the model term type
in the parentheses, separated by commas. Boolean options are
specified by simply adding the option name. For example, a random
intercept term with #a=b=0.001# as parameters for the inverse
gamma prior of the variance parameter is
specified as follows:

#X1*grvar(random,a_re=0.001,b_re=0.001)#

Note that all options may be specified in arbitrary order.
\autoref{mcmcregoptions1} and \autoref{mcmcregoptions2} provide explanations and the default values of
all possible options. All reasonable combinations of model terms
and options can be found in \autoref{mcmctermsoptions}.

%------------------------------------------------------------------------------%

\begin{table}[ht] \footnotesize
\begin{center}
\begin{tabular}{|p{2.8cm}|p{3.6cm}|p{7.1cm}|}
\hline
{\bf Type} & {\bf Syntax example} & {\bf Description} \\
\hline \hline
Offset & #offs(offset)#  & Variable #offs# is an offset term. \\
\hline
Linear effect & #W1#  & Linear effect of #W1#. \\
\hline
Ridge effect & #X1(ridge)#  & Linear effect of #X1# with ridge prior. \\
\hline
Lasso effect & #X1(lasso)#  & Linear effect of #X1# with lasso prior. \\
%\hline
%NMIG effect & #X1(ssvs)#  & Linear effect of #X1# with ssvs-penalty. \\
\hline
P-spline &  #X1(pspline)#   & Nonlinear effect of #X1#.  \\
\hline Markov random \newline field &  #region(spatial,map=m)#  &
Spatial effect of #region# where #region# indicates the region an
observation pertains to. The boundary information and the
neighborhood structure are stored in the {\em map object}
#m#. \\
\hline Two dimensional \newline kriging term &
#region(geospline,map=m)# & Spatial effect of #region#. Estimates
a two dimensional kriging term
based on the centroids of the regions. The centroids are obtained from the {\em map object} #m#. \\
\hline Random intercept &  #grvar(random)# & I.i.d. Gaussian
(random) effect of the group indicator #grvar#,
e.g.~#grvar# may be an individual indicator when analyzing longitudinal data.  \\
\hline
\end{tabular}
{\em\caption {\label{mcmcterms} Overview over different model terms
for mcmcreg objects.}}
\end{center}
\end{table}



\begin{table}[ht] \footnotesize
\begin{center}
\begin{tabular}{|p{3.5cm}|p{3.8cm}|p{5.9cm}|}
\hline
{\bf Type of interaction} & {\bf Syntax example} & {\bf Description} \\
\hline
\hline
Varying coefficient term &  #X1*X2(pspline)#
 & Effect of
#X1# varies smoothly over the range of the continuous covariate #X2# or #time#. \\
\hline Random slope & #X1*grvar(random)#  &  The regression
coefficient of #X1# varies with respect
to the unit- or cluster-index variable #grvar#. \\
\hline Geographically weighted \newline regression &
#X1*region(spatial,map=m)#  & Effect of #X1# varies
geographically. Covariate
#region# indicates the region an observation pertains to. \\
\hline Two dimensional \newline kriging term &  #X1*X2(kriging)#
& Two dimensional surface for the continuous
covariates #X1# and #X2#. \\
 \hline
\end{tabular}
{\em\caption {\label{mcmcreginteractions} Possible interaction terms for mcmcreg objects.}}
\end{center}
\end{table}

%------------------------------------------------------------------------------%




% STEFAN: noch beschreiben

%  internal_mult = simpleoption("internal_mult",false);
%  samplemult = simpleoption("samplemult",false);
%  internal_multexp = simpleoption("internal_multexp",false);
%  sum2 = doubleoption("sum2",0,0,10000000);


%  shrinkage = doubleoption("shrinkage",1,0,10000000);
%  shrinkagefix = simpleoption("shrinkagefix",false);
%  shrinkageweight = doubleoption("shrinkageweight",1,0,10000000);
%  adaptiveshrinkage = simpleoption("adaptive",false);
%  tau2 = doubleoption("tau2",1,0.000000000001,100000000);
%  vector<ST::string> priors;
%  priors.push_back("iid");
%  priors.push_back("lasso");
%  priors.push_back("dirichlet");
%  priors.push_back("nmig");
%  priors.push_back("ssvs");
%  prior = stroption("prior",priors,"iid");
% center = simpleoption("center",false);
%  abeta = doubleoption("abeta",1,0.00000001,500);
%  bbeta = doubleoption("bbeta",1,0.00000001,500);
%  r = doubleoption("r",0.000025,0.0000000001,1);
%  v = doubleoption("v",5,0.0000000001,500);
%  aQ = doubleoption("aQ",1,0.00000001,500);
%  bQ = doubleoption("bQ",1,0.00000001,500);
%  regiterates = intoption("regiterates",1000,0,1000000000);
%  tildea = doubleoption("tildea",-0.5,-1.0,500);
%  tildeb = doubleoption("tildeb",0,0,500);
%  cauchy = simpleoption("cauchy",false);

%   ccovariate = simpleoption("ccovariate",false);




\begin{table}[ht] \footnotesize \centering
\begin{tabular}{|l|p{0.6\linewidth}|c|}
\hline {\bf Option} & {\bf Description} & {\bf Default} \\
\hline
\hline
#a#, #b# & The options #a# and #b# specify the hyperparameters of
  the inverse Gamma prior for the variance $\tau^2$ of nonlinear effects (e.g. P-splines or Markov random fields).
& #a=0.001#, #b=0.001# \\
\hline
#a_re#, #b_re# & The options #a_re# and #b_re# specify the hyperparameters of
the inverse Gamma prior for the variance $\tau^2$ of random effects (random or hrandom).
& #a_re=0.001#, #b_re=0.001# \\
\hline
#binning# & uses binning of the covariate according to \citeasnoun{LanUml14}. & #binning=-1# (no binning) \\
\hline
#centermethod# & Defines the method for centering nonlinear terms (e.g. P-splines). & #centermethod=meanfd# \\
               & #centermethods = meanf# &          \\
               & Centered sampling such that the sum of the $f(x)$ over {\em all} observations is zero. & \\
               & #centermethods = meanfd# &          \\
               & Centered sampling such that the sum of the $f(x)$ over the {\em distinct} observations is zero. & \\
               & #centermethods = meancoeff# &          \\
               & Centered sampling such that the sum of the regression coefficients is zero. & \\
               & #centermethods = meansimple# &          \\
               & Center the parameters around zero (after they have been sampled). & \\
%  centermethods.push_back("meanintegral");
%  centermethods.push_back("meaninvvar");
%  centermethods.push_back("nullspace");
%  centermethods.push_back("integralsimple");      // subtract mean from parameters
%  centermethods.push_back("meansum2");
\hline
#constraints# & Defines monotonicity constraints for P-splines. Specifying #constraints=increasing# yields
increasing nonlinear functions and #constraints=decreasing# yields decreasing functions. &
#constraints = unrestricted# \\
\hline
#degree# & Specifies the degree of B-spline basis functions for P-splines. & #degree=3# \\
\hline
#derivative# & If specified, first order derivatives of the
function estimate are computed (for P-splines only). & - \\
\hline
#difforder# & Specifies the difference order (1 or 2) of random walks for P-spline priors. & 2 \\
\hline
#lambda#
& Provides a starting value for the smoothing parameter $\lambda$. NOTE: In distributional regression models with more than one equation it may be better to specifiy #lambda=100#. & #lambda=10# \\
\hline
#lambda_re#
& Provides a starting value for the smoothing parameter $\lambda$ for random effects (random or hrandom). & #lambda_re=0.1# \\
\hline
#nocenter# & Indicates that a nonlinear term should not be centered. & - \\
\hline
#nu# & Specifies the parameter #nu# of the Matern family of covariance functions (kriging terms only).  & #nu=1.5# \\
\hline
#nrknots# & Specifies the number of inner knots for a P-spline
term. & #nrknots=20# \\
\hline
%#maxdist# & FEHLT (kriging) & maxdist=-1 \\
%\hline
#meaneffect# & Indicates that mean effects (expected values) of the response in dependence of the covariate (with other covariates held fixed at mean values) should be computed. &  - \\
\hline
#round# & Rounds the covariate before estimation, e.g. #round=2# rounds to 2 digits after the decimal point. & round=-1 (no rounding) \\
\hline
\end{tabular}
{\em\caption{\label{mcmcregoptions1} Optional arguments for mcmcreg
object terms in alphabetical order (1).}}
\end{table}







\begin{table}[ht] \footnotesize \centering
\begin{tabular}{|l|p{0.6\linewidth}|c|}
\hline
{\bf Option} & {\bf Description} & {\bf Default} \\
\hline
#samplederivative# & Indicates that samples of the derivatives should be stored. If this is the case, credible intervals,
standard errors etc. for derivatives are computed in addition to mean estimates. This option is only meaningful in combination with option #derivative#. & - \\
\hline
#samplef# & Indicates that samples for the nonlinear functions in addition to samples of regression coefficients should be stored. & - \\
\hline
#updatem# & Specifies the method for updating regression coefficients in the MCMC sampler. #update=direct# uses direct updating
by sampling from the full conditionals in case of gaussian responses or by IWLS proposals in case of non-gaussian responses  , #update=orthogonal# uses orthogonal bases as described in \citeasnoun{LanUml14}. & #updatem=direct# \\
\hline
\end{tabular}
{\em\caption{\label{mcmcregoptions2} Optional arguments for mcmcreg
object terms in alphabetical order (2).}}
\end{table}



\begin{sidewaystable} \footnotesize
\begin{tabular}{|l||c|c|c|c|c|}

\hline
             & pspline     & spatial     & random      & kriging     & geokriging  \\
\hline\hline
#a#          & realvalue   & realvalue   & $\times$     & realvalue   & realvalue  \\
\hline
#b#           & realvalue   & realvalue   & $\times$     & realvalue   & realvalue  \\
\hline
#a_re#       & $\times$     & $\times$     & realvalue   & $\times$     & $\times$   \\
\hline
#b_re#       & $\times$     & $\times$     & realvalue   & $\times$     & $\times$   \\
\hline
#binning# & -1, integervalue     & $\times$     & $\times$   & $\times$     & $\times$   \\
\hline
#centermethod# & $\ast$ & $\ast$    & $\times$     & $\times$   & $\times$    \\
\hline
#constraints#  & $\bullet$     & $\times$    & $\times$    & $\times$ &  $\times$ \\
\hline
#degree#      &  integer    & $\times$    & $\times$    & $\times$ &  $\times$ \\
\hline
#derivative#  & $\triangle$ & $\times$      & $\times$  & $\times$ & $\times$  \\
\hline
#lambda#     & realvalue   & realvalue   & realvalue   & realvalue   & realvalue  \\
\hline
#nrknots#    &  integer    & $\times$     & $\times$   & $\times$    & $\times$ \\
\hline
#nocenter# & $\triangle$  & $\triangle$    & $\times$   & $\times$    & $\times$ \\
\hline
#nu# & $\times$   & $\times$     & $\times$   &  0.5,1.5,2.5,3.5    & 0.5,1.5,2.5,3.5 \\
\hline
#map#  & $\times$  & {\em map object}  & $\times$  & $\times$ & {\em map object} \\
\hline
#maxdist# & $\times$ & $\times$   & $\times$  & realvalue & realvalue  \\
\hline
#meaneffect# & $\triangle$ & $\triangle$  & $\triangle$  & $\triangle$ & $\triangle$  \\
\hline
#round#  & realvalue & $\times$      & $\times$  & $\times$ & $\times$  \\
\hline
#samplederivative#  & $\triangle$ & $\times$      & $\times$  & $\times$ & $\times$  \\
\hline
#samplef#  & $\triangle$ & $\triangle$  & $\triangle$  & $\triangle$ & $\triangle$  \\
\hline
#updatem#  & $\circ$ & $\circ$  & $\circ$  & $\circ$ & $\circ$  \\
\hline
$\times$    & \multicolumn{5}{l|}{not available} \\
\hline
$\ast$  & \multicolumn{5}{l|}{admissible values are #meanfd,meanf,meanfd,meancoeff,meansimple#} \\
\hline
$\circ$  & \multicolumn{5}{l|}{admissible values are #direct,orthogonal#} \\
\hline
$\bullet$  & \multicolumn{5}{l|}{admissible values are #unrestricted,increasing,decreasing#} \\
\hline
$\triangle$   & \multicolumn{5}{l|}{available as boolean option (specified without supplying a value)} \\
\hline
\end{tabular}
{\em\centering \caption{\label{mcmctermsoptions} Terms and options for mcmcreg objects.}}
\end{sidewaystable}




\clearpage

\subsubsection{Specifying the response distribution}
\index{Response distribution} \label{mcmcregfamilysyntax}

An overview of supported univariate distributions is given in Tables~\ref{tab:distrBayesX1}, \ref{tab:distrBayesX2} and \ref{tab:distrBayesX3}.
Supported multivariate distributions are presented in Table~\ref{tab:distrBayesX4}.
{\em mcmcreg objects}
allow to define for each parameter of a specific distribution a full STAR predictor. This is done
by defining for each parameter of the distribution a separate model equation. To define the equation
type, the user has to specify the (global) options #family# and #equationtype#.
In some cases, one or more additional
options associated with the specified response distribution can be
specified. In the following,
we give detailed instructions on how to specify the various
models for two distributions, the Gaussian and Gamma distribution. For the other distributions
the specification is analogous. Special cases are the hurdle and beta inflated models which are discussed below.






\begin{sidewaystable}[htbp]
\begin{center} %\footnotesize
\begin{tabular}{l l c l l}
\hline\hline
% \multicolumn{5}{l}
{1. Continuous distributions on $\dsR$}&Density&Parameter&#family#&#equationtype#\\\hline
 Normal &$p(y|\mu,\sigma^2)=\frac{1}{\sqrt{2\pi\sigma^2}}\exp\left(-\frac{(y-\mu)^2}{2\sigma^2}\right)$ &$\sigma^2>0$ &#normal#&#sigma2#\\
 &&$\mu\in\dsR$&#normal#&#mu#\\\hline
 Normal &$p(y|\mu,\sigma)=\frac{1}{\sqrt{2\pi\sigma^2}}\exp\left(-\frac{(y-\mu)^2}{2\sigma^2}\right)$ &$\sigma>0$ &#normal2#&#sigma#\\
  &&$\mu\in\dsR$&#normal2#&#mu#\\\hline
 t& $p(y|\mu,\sigma^2,\mathit{df})=\frac{\Gamma\left((\mathit{df}+1)/2\right)}{\Gamma(1/2)\Gamma(\mathit{df}/2)\sqrt{\mathit{df}\sigma^2}}\left(1+\frac{(y-\mu)^2}{\mathit{df}\sigma^2}\right)^{-\frac{\mathit{df}+1}{2}}$&$\mathit{df}>0$&#t#&#df#\\
 &&$\sigma^2>0$&#t#&#sigma2#\\
 &&$\mu\in\dsR$&#t#&#mu#\\
% Skew normal & $p(y|\mu,\sigma^2,\alpha) = \frac{2}{\sigma^2}\phi\left(\frac{y-\mu}{\sigma^2}\right)\Phi\left(\alpha\frac{y-\mu}{\sigma^2}\right)$&$\mu,\alpha\in\dsR,\sigma^2>0$\\
 %& $\phi$, $\Phi$ density and cdf of the standard normal distribution & \\
 \hline
 \multicolumn{5}{l}{2. Continuous distributions on $\dsR^+$} \\\hline
Log-normal & 	$p(y|\mu,\sigma^2)=\frac{1}{\sqrt{2\pi\sigma^2} y}\exp\left(-\frac{(\log(y)-\mu)^2}{2\sigma^2}\right)$ &$\sigma^2>0$&#lognormal#&#sigma2# \\
&&$\mu\in\dsR$&#lognormal#&#mu#\\\hline
Log-normal & 	$p(y|\mu,\sigma)=\frac{1}{\sqrt{2\pi\sigma^2} y}\exp\left(-\frac{(\log(y)-\mu)^2}{2\sigma^2}\right)$ &$\sigma>0$&#lognormal2#&#sigma# \\
&&$\mu\in\dsR$&#lognormal2#&#mu#\\\hline
Inverse Gaussian &	$p(y|\mu,\sigma^2)=\frac{1}{\sqrt{2\pi\sigma^2} y^{3/2}}\exp\left(-\frac{(y-\mu)^2}{2 y\mu^2\sigma^2}\right)$&$\sigma^2>0$&#invgaussian# &#sigma2#\\
&&$\mu>0$&#invgaussian#&#mu#\\\hline
Gamma & $p(y|\mu,\sigma)=\left(\frac{\sigma}{\mu}\right)^{\sigma}\frac{y^{\sigma-1}}{\Gamma(\sigma)}\exp\left(-\frac{\sigma}{\mu}y\right)$&$\sigma>0$&#gamma#&#sigma# \\
&&$\mu>0$&#gamma#&#mu#\\\hline
Weibull & $	p(y|\lambda,\alpha)=\alpha\lambda^{\alpha} y^{\alpha-1}\exp\left(-\left(\lambda y\right)^{\alpha}\right)$&$\alpha>0$&#weibull#&#alpha# \\
&&$\lambda>0$&#weibull#&#lambda#\\\hline
Pareto & $p(y|b,p)=p b^{p}(y+p)^{-p-1}$&$p>0$&#pareto#&#p#\\
&&$b>0$&#pareto#&#b#\\\hline
%Truncated normal &$p(y|\mu,\sigma^2)=\frac{1}{\sqrt{2\pi\sigma^2}}\exp\left(-\frac{(y-\mu)^2}{2\sigma^2}\right)\frac{1}{\sigma(-\Phi\left(-\mu/\sigma\right))}$&$\sigma^2>0$&#truncnormal#&#sigma2#\\
% &&$\mu\in\dsR$&#truncnormal#&#mu#\\\hline
 Truncated normal &$p(y|\mu,\sigma)=\frac{1}{\sqrt{2\pi\sigma^2}}\exp\left(-\frac{(y-\mu)^2}{2\sigma^2}\right)\frac{1}{\sigma(-\Phi\left(-\mu/\sigma\right))}$&$\sigma>0$&#truncnormal2#&#sigma#\\
  &&$\mu\in\dsR$&#truncnormal2#&#mu#\\\hline
Generalized gamma & $p(y|\mu,\sigma,\tau)=\left(\frac{\sigma}{\mu}\right)^{\sigma\tau}\frac{\tau y^{\sigma\tau-1}}{\Gamma(\sigma)}\exp\left(-\left(\frac{\sigma}{\mu}y\right)^{\tau}\right)$&$\tau>0$&#gengamma#&#tau#\\
&&$\sigma>0$&#gengamma#&#sigma#\\
&&$\mu>0$&#gengamma#&#mu#\\\hline
Dagum & $p(y|a,b,p)=\frac{a p y^{a p-1}}{b^{a p}\left(1+\left(y/b\right)^{a}\right)^{p+1}}$&$p>0$&#dagum#&#p# \\
&&$b>0$&#dagum#&#b#\\
&&$a>0$&#dagum#&#a#\\\hline\hline
\end{tabular}
\end{center}\caption{List of possible response distributions in distributional regression.}\label{tab:distrBayesX1}
\end{sidewaystable}

\begin{sidewaystable}[htbp]
\begin{center} %\scriptsize
\begin{tabular}{l l c l l}
\hline\hline
% \multicolumn{5}{l}
{3. Discrete distributions}&Density&Parameter&#family#&#equationtype#\\\hline

%\multicolumn{5}{l}{3. Discrete distributions}\\\hline
Poisson & $p(y|\lambda)=\frac{\lambda^{y}\exp(-\lambda)}{y!}$ & $\lambda>0$&#poisson#&#lambda#\\\hline
Negative binomial &  $p(y|\mu,\delta) = \frac{\Gamma(y+\delta)}{\Gamma(y+1)\Gamma(\delta)}\left(\frac{\delta}{\delta+\mu}\right)^{\delta}\left(\frac{\mu}{\delta+\mu}\right)^{y}$ &$\delta>0$&#negbin#&#delta#\\
&&$\mu>0$&#negbin#&#mu#\\\hline
Zero-inflated Poisson &$p(y|\lambda,\pi) = \pi\mathds{1}_{\lbrace 0\rbrace}(y)+(1-\pi)\frac{\lambda^{y}\exp(-\lambda)}{y!}$& $\pi\in(0,1)$&#zip#&#pi#\\
&&$\lambda>0$&#zip#&#lambda#\\\hline
Zero-inflated negative binomial &$p(y|\pi,\mu,\delta) = \pi\mathds{1}_{\lbrace 0\rbrace}(y)+\frac{(1-\pi)\Gamma(y+\delta)}{\Gamma(y+1)\Gamma(\delta)}\left(\frac{\delta}{\delta+\mu}\right)^{\delta}\left(\frac{\mu}{\delta+\mu}\right)^{y}$&$\delta>0$&#zinb#&#delta#\\
&&$\pi\in(0,1)$&#zinb#&#pi#\\
&&$\mu>0$&#zinb#&#mu#\\\hline
Hurdle Poisson &$p(y|\lambda,\pi)=\begin{cases}
	\pi & y=0\\
		\frac{(1-\pi)}{1-\exp(-\lambda)}\frac{\lambda^{y}\exp(-\lambda)}{y!} & y>0\\
			\end{cases}$&$\begin{matrix} \pi\in(0,1)\\\lambda>0
					 	\end{matrix}$ &$\begin{matrix} \text{#hurdle#}\\\text{#hurdle#}
					\end{matrix}$&$\begin{matrix} \text{#pi#}\\\text{#lambda#}\\
					\end{matrix}$\\\hline
Hurdle negative binomial &$p(y|\mu,\delta,\pi)=\begin{cases}
	\pi & y=0\\
		\frac{(1-\pi)}{1-\left(\frac{\delta}{\delta+\mu}\right)^{\delta}}\frac{\Gamma(y+\delta)}{\Gamma(y+1)\Gamma(\delta)}\left(\frac{\delta}{\delta+\mu}\right)^{\delta}\left(\frac{\mu}{\delta+\mu}\right)^{y} & y>0\\
			\end{cases}$&$\begin{matrix} \pi\in(0,1)\\\delta>0\\\mu>0
					 	\end{matrix}$ &$\begin{matrix} \text{#hurdle#}\\\text{#hurdle#}\\\text{#hurdle#}
					\end{matrix}$&$\begin{matrix} \text{#pi#}\\\text{#delta#}\\\text{#mu#}
					\end{matrix}$\\\hline
Binomial &$p(y|\pi)=\begin{cases}
	\pi & y=0\\
		(1-\pi) & y=1\\
			\end{cases}$&$\pi\in(0,1)$&#binomial_logit#&#pi#\\\hline
Cloglog &$p(y|\pi)=\begin{cases}
	\pi & y=0\\
		(1-\pi) & y=1\\
			\end{cases}$&$\pi\in(0,1)$&#binomial_cloglog#&#pi#\\\hline
Probit &$p(y|\pi)=\begin{cases}
	\pi & y=0\\
		(1-\pi) & y=1\\
			\end{cases}$&$\pi\in(0,1)$&#binomial_probit#&#pi#\\
\hline\hline
\end{tabular}
\end{center}\caption{List of possible response distributions.}\label{tab:distrBayesX2}
\end{sidewaystable}

\begin{sidewaystable}[htbp]
\begin{center} %\scriptsize
\begin{tabular}{l l c l l}
\hline\hline
% \multicolumn{5}{l}
{4. Mixed discrete-continuous distributions}  \\\hline
Zero-adjusted & $p(y|\pi,g(y)) = \begin{cases} 1-\pi & y = 0\\
									\pi g(y) & y>0
								 \end{cases}$& &#za#&\\
& $g(y)$ a distribution from 2. &\\\hline
\multicolumn{5}{l}{5. Distributions with compact support} \\\hline
Beta & $p(y|\mu,\sigma^2)=\frac{y^{p-1}\left(1-y\right)^{q-1}}{\B(p,q)}$&$\sigma^2\in(0,1)$&#beta#&#sigma2#\\
&$\mu=\frac{p}{p+q}$, $\sigma^2=\frac{1}{p+q+1}$&$\mu\in(0,1)$&#beta#&#mu#\\\hline
Zero-One-inflated Beta & $p(y|\mu,\sigma^2,\upsilon,\tau)=\begin{cases}
\frac{\upsilon}{1+\upsilon+\tau} & y=0\\\left(1-\frac{\upsilon+\tau}{1+\upsilon+\tau}\right)\frac{y^{p-1}\left(1-y\right)^{q-1}}{\B(p,q)} & y\in(0,1)\\
\frac{\tau}{1+\upsilon+\tau}
 & y=1
 	\end{cases}$&$\begin{matrix} \sigma^2\in(0,1)\\\mu\in(0,1)\\\upsilon>0\\\tau>0
 	\end{matrix}$ &$\begin{matrix} \text{#betainf#}\\\text{#betainf#}\\\text{#betainf#}\\\text{#betainf#}
\end{matrix}$&$\begin{matrix} \text{#sigma2#}\\\text{#mu#}\\\text{#nu#}\\\text{#tau#}
\end{matrix}$\\\hline
Zero-inflated Beta & $p(y|\mu,\sigma^2,\upsilon)=\begin{cases}
	\frac{\upsilon}{1+\upsilon} & y=0\\\left(1-\frac{\upsilon}{1+\upsilon}\right)\frac{y^{p-1}\left(1-y\right)^{q-1}}{\B(p,q)} & y\in(0,1)\\
		\end{cases}$&$\begin{matrix} \sigma^2\in(0,1)\\\mu\in(0,1)\\\upsilon>0
		 	\end{matrix}$ &$\begin{matrix} \text{#betainf0#}\\\text{#betainf0#}\\\text{#betainf0#}
		\end{matrix}$&$\begin{matrix} \text{#sigma2#}\\\text{#mu#}\\\text{#nu#}
		\end{matrix}$\\\hline
One-inflated Beta & $p(y|\mu,\sigma^2,\tau)=\begin{cases}
		\left(1-\frac{\tau}{1+\tau}\right)\frac{y^{p-1}\left(1-y\right)^{q-1}}{\B(p,q)} & y\in(0,1)\\
		\frac{\tau}{1+\tau} & y=1\\
			\end{cases}$&$\begin{matrix} \sigma^2\in(0,1)\\\mu\in(0,1)\\\tau>0
					 	\end{matrix}$ &$\begin{matrix} \text{#betainf1#}\\\text{#betainf1#}\\\text{#betainf1#}
					\end{matrix}$&$\begin{matrix} \text{#sigma2#}\\\text{#mu#}\\\text{#tau#}
					\end{matrix}$\\\hline\hline
\end{tabular}
\end{center}\caption{List of possible response distributions.}\label{tab:distrBayesX3}
\end{sidewaystable}

\begin{sidewaystable}[htbp]
\begin{center} %\scriptsize
\begin{tabular}{l l c l l}
\hline\hline
% \multicolumn{5}{l}
{6. Multivariate distributions}&Density&Parameter&#family#&#equationtype#\\\hline
%\multicolumn{5}{l}{6. Multivariate distributions} \\\hline	
Bivariate normal& $p(y_1,y_2) = \frac{1}{\sqrt{(2\pi)^2 \det(\mSigma)}}\exp\left(-\frac{1}{2}\left(\yvec-\muvec\right)'\mSigma^{-1}\left(\yvec-\muvec\right)\right)$&$\rho\in[-1,1]$&#bivnormal#&#rho#\\
&$\yvec=(y_1,y_2)'$&$\sigma_2>0$&#bivnormal#&#sigma#\\
&$\muvec=(\mu_1,\mu_2)'$&$\sigma_1>0$&#bivnormal#&#sigma#\\
&$\mSigma = \left(\begin{matrix}
\sigma_1^2 & \rho\sigma_1\sigma_2\\
\rho\sigma_1\sigma_2& \sigma_2^2 \\
\end{matrix}\right)$&$\mu_2>0$&#bivnormal#&#mu#\\
&&$\mu_1>0$&#bivnormal#&#mu#\\\hline
Bivariate normal (Fishers-$z$)&$p(y_1,y_2) = \frac{1}{\sqrt{(2\pi)^2 \det(\mSigma)}}\exp\left(-\frac{1}{2}\left(\yvec-\muvec\right)'\mSigma^{-1}\left(\yvec-\muvec\right)\right)$ &$\rho\in[-1,1]$&#bivnormal_fz#&#rho#\\
&&$\sigma_2>0$&#bivnormal_fz#&#sigma#\\
&&$\sigma_1>0$&#bivnormal_fz#&#sigma#\\
&&$\mu_2>0$&#bivnormal_fz#&#mu#\\
&&$\mu_1>0$&#bivnormal_fz#&#mu#\\\hline
Bivariate t &$f(y_1,y_2) = \frac{\Gamma\left(\frac{\mathit{df}+D}{2}\right)}{\Gamma\left(\frac{\mathit{df}}{2}\right)\left(\mathit{df}\pi\right)}\left(\det\left(\mSigma\right)\right)^{-\frac12}\left[1+\left(\yvec-\muvec\right)'\mSigma^{-1}\left(\yvec-\muvec\right)\right]^{-\frac{\mathit{df}+2}{2}}$&$\mathit{df}>0$&#bivt#&#df#\\
 &&$\rho\in[-1,1]$&#bivt#&#rho#\\
 &&$\sigma_2>0$&#bivt#&#sigma#\\
 &&$\sigma_1>0$&#bivt#&#sigma#\\
 &&$\mu_2>0$&#bivt#&#mu#\\
 &&$\mu_1>0$&#bivt#&#mu#\\\hline
Bivariate probit &$\yvec^\ast=\etavec^{\mu}+\meps, \qquad \meps\sim\N\left(\nullvec,\mSigma\right)$,
$\mSigma = \left(\begin{matrix}
1 & \rho\\
\rho& 1\\
\end{matrix}\right)$&$\rho\in[-1,1]$&#bivprobit#&#rho#\\
&$y_{d}=1 \Longleftrightarrow y_{d}^\ast	> 0$&$\mu_2>0$&#bivprobit#&#mu#\\
&$d=1,2$&$\mu_1>0$&#bivprobit#&#mu#\\\hline
Bivariate logit & $p(y|p_1,p_2,\psi)=\begin{cases}
p_{11}=\psi p_{01}p_{10}/p_{00} & y_1=y_2=1\\p_{10}=p_1-p_{11} & y_1=y_2=0\\
p_{01}=p_2-p_{11} & y_0=y_2=1\\
p_{00}=1-p_{10}-p_{01}-p_{11} & y_0=y_2=0\\
 	\end{cases}$&$\begin{matrix} \psi>0\\p_2\in(0,1)\\p_1>0
 	\end{matrix}$ &$\begin{matrix} \text{#bivlogit#}\\\text{#bivlogit#}\\\text{#bivlogit#}
\end{matrix}$&$\begin{matrix} \text{#oddsratio#}\\\text{#mu#}\\\text{#mu#}
\end{matrix}$\\\hline
Dirichlet &$p(y_1,\ldots,y_{D-1}) = \frac{1}{\B(\alphavec)}\prod_{d=1}^{D}y_d^{\alpha_d-1},\;\B{(\alphavec)}=\frac{\prod_{d=1}^{D}\Gamma(\alpha_d)}{\Gamma\left(\sum_{d=1}^{D}\alpha_d\right)}$&$\alpha_d>0$&#dirichlet#&#alpha#\\	
&$\sum_{d=1}^D y_d = 1$&$D\geq 2$&&\\
\hline\hline
\end{tabular}
\end{center}\caption{List of possible response distributions.}\label{tab:distrBayesX4}
\end{sidewaystable}



\subsubsection*{Gaussian responses}

The classical Gaussian regression model is specified with homoscedastic variances, i.e.~the responses $y_i$ are Gaussian with expected value $\mu = \eta_i$ depending on covariates and homoscedastic variance $\sigma^2$ not depending on covariates. The homoscedastic Gaussian model is specified as

#b.hregress depvar = const + term1 + ... , family=normal equationtype=mu using d#

where #depvar# is the response variable, #term1# is a specific covariate effect to be specified as outlined in the previous section and #d# is the name of the dataset object where the data are stored. The dots indicate that there might be other covariate terms in the equation. Since we are dealing with homoscedastic models where only the mean $\mu$ depends on covariates
the specification of the #equationtype# as done above is not necessary.

A Gaussian regression model with heteroscedastic variances $\sigma^2_i$ depending on covariates is specified as:

#b.hregress depvar = const + s_term1 + ..., family=normal equationtype=sigma2#
#using d#

#b.hregress depvar = const + m_term1 + ..., family=normal equationtype=mu#
#using d#

The covariates and the respective terms can be completely different in the variance and mean equation.
It is also possible to model the standard deviation $\sigma$ rather than the variance $\sigma^2$ using the syntax:

#b.hregress depvar = const + s_term1 + ..., family=normal2 equationtype=sigma#
# using d#

#b.hregress depvar = const + m_term1 + ..., family=normal2 equationtype=mu#
#using d#

Note that we have to specify #family=normal2# rather than #family=normal# when using the standard deviation.


\subsubsection*{Gamma distributed responses}


Gamma distributed responses are specified with the following two equations, one for the parameter $\sigma$ and one for the expected value
$\mu$:


#b.hregress depvar = const + s_term1 + ..., family=gamma equationtype=sigma#
#using d#

#b.hregress depvar = const + m_term1 + ..., family=gamma equationtype=mu#
#using d#

A model with constant parameter $\sigma$ not depending on covariates is given by:

#b.hregress depvar = const  , family=gamma equationtype=sigma#
#using d#

#b.hregress depvar = const + m_term1 + ... , family=gamma equationtype=mu#
#using d#



%\subsubsection*{Hurdle models}
%
%
%For hurdle models additional weights have to be specified and need to be put in the #lambda# equation (hurdle Poisson) and the #mu#, #delta# equations (hurdle negbin). Note also that the first observation in the data set needs to be with a response variable greater than zero!
%
%#d.generate w=1#
%
%#d.replace w=0 if depvar=0#
%
%#b.hregress depvar = const + s_term1 + ..., family=hurdle equationtype=pi#
%#using d#
%
%#b.hregress depvar = const + m_term1 + ... weight w, family=hurdle equationtype=lambda#
%#using d#
%
%Analogue the hurdle negbin model is specified.
%
%
%\subsubsection*{Beta inflated models}
%
%
%For families #betainf#, #betainf0# and #betainf1# additional weights for the #mu# and #sigma2# equation have to be defined:
%
%#d.generate w=1#
%
%#d.replace w=0 if depvar=0#
%
%#d.replace w=0 if depvar=1#
%
%#b.hregress depvar = const + s_term1 + ... weight w, family=betainf equationtype=sigma2#
%#using d#
%
%#b.hregress depvar = const + m_term1 + ... weight w, family=betainf equationtype=mu#
%#using d#
%
%#b.hregress depvar = const + m_term1 + ..., family=betainf equationtype=nu#
%#using d#
%
%#b.hregress depvar = const + m_term1 + ..., family=betainf equationtype=tau#
%#using d#
%
%Analogue the #betainf0# and #betainf1# models are specified.

\subsubsection*{Zero-adjusted models}

The following example is along a zero-adjusted log normal model with parameters #pi#, #mu# and #sigma2#.
For #pi# there are always the options to choose between a logit, probit and complementary log-log response function.
These equations need to specified with #family=za_binomial_logit#, #family=za_binomial\_probit#, #family=za_binomial_cloglog#.
For the continuous part, use #family=za_# + the name of the family for the continuous distribution.


#b.hregress depvar = const + s_term1 + ..., family=za_binomial_logit equationtype=pi#
#using d#

#b.hregress depvar = const + m_term1 + ..., family=za_lognormal equationtype=sigma2#
#using d#

#b.hregress depvar = const + m_term1 + ..., family=za_lognormal equationtype=mu#
#using d#

#b.hregress depvar, family=za#
#using d#



\subsubsection{Hierarchical or multilevel models}
\index{Hierarchical models} \label{mcmcregmultilevelsyntax}
\index{Multilevel models}

\paragraph{Random intercept models}

$ $ \\

As already mentioned at various places in the manuals, BayesX is able to specify and estimate hierarchical or
multilevel models, see section \ref{star_multilevel} in the methodology manual and in particular the paper by
\citeasnoun{LanUml14}. Suppose we want to estimate a homoscedastic Gaussian regression model with response variable
$y$, P-spline effects $f_1(X1)$ and $f_2(X2)$ for the continuous covariates $X1$ and $X2$, and a random intercept for the
cluster variable $C$. Assume further that $X1$ is an individual specific covariate whereas $X2$ is a cluster specific covariate
according to the cluster variable $C$. Then the model can be specified as:

#b.hregress y = const + X1(pspline)  + X2(pspline) + C(random) , family=normal#

#equationtype=mu using d#

As an alternative to this specification, the model could be defined in hierarchical form. To do so we first need a second dataset dC, say,
where the unique observations of the two cluster variables $C$ and $x2$ are stored. The first 5 lines of this dataset in ASCII format may look like this:

\begin{verbatim}
C X2
1 -2.3
2 2.2
3 1.4
4 3
5 -1.6
\end{verbatim}

Note that the values of the cluster variable $C$ must be stored in increasing order! Now the model can be reformulated in hierarchical order as
follows:

#b.hregress C = X2(pspline) , family=gaussian_re equationtype=mu using dC#

#b.hregress y = const + X1(pspline)  + C(hrandom) , family=normal#

#equationtype=mu using d#

In this form we have defined the random intercept with additional nonlinear covariate effect of the cluster specific
variable $X2$ using a separate equation. While this specification is formally equivalent to the first
model definition, estimation is now carried out in the hierarchical way as described in detail in \citeasnoun{LanUml14}. The hierarchical
formulation is usually more favorable as the computing time for every iteration is reduced and also the mixing of the MCMC sampler (sometimes
dramatically) improves.

\paragraph{Random slope models}

$ $ \\

It is also possible estimate random slopes hierarchically. Suppose we want to estimate an interaction effect (random slope) between the individual specific covariate $X1$ and the cluster variable $C$. In non-hierarchical form we obtain:

#b.hregress y = const + X1(pspline)  + X2(pspline) + C(random) + X1*C(random) ,#
#family=normal equationtype=mu using d#

The same model in hierarchical form is given as:

#b.hregress C = X2(pspline) , family=gaussian_re equationtype=mu using dC#

#dC.generate C2 = C#

#b.hregress C2 = const , family=gaussian_re equationtype=mu using dC#

#d.generate C2 = C#

#b.hregress y = const + X1(pspline)  + C(hrandom) + X1*C2(hrandom) ,#

#family=normal equationtype=mu using d#

Note that we have to duplicate the cluster variable $C$ in both datasets in order to distinguish the random slope equation
from the random intercept equation.


\paragraph{Three level models}

$ $ \\

BayesX is able to estimate hierarchical models with arbitrary number of hierarchy levels. Suppose there is another cluster variable
$D$ which is nested in $C$. Suppose further that we have an additional covariate X3 at cluster level $D$. Then a three level random intercept
model is defined hierarchically as follows:

#b.hregress C = X3   , family=gaussian_re equationtype=mu using dD#

#b.hregress C = X2(pspline) + D(hrandom)  , family=gaussian_re#

#equationtype=mu using dC#

#b.hregress y = const + X1(pspline)  + C(hrandom) , family=normal#

#equationtype=mu using d#

Here the cluster level dataset for variable $D$ is dD. For the cluster level covariate X3 a linear effect is assumed.

Random slope models could be defined analogously.

\paragraph{Placing the overall intercept}

$ $ \\

Placing the overall intercept in hierarchical models is a delicate issue as it can have a strong impact on the
mixing behaviour of the resulting Markov chains.
Usually the best option is to place the overall intercept in the lowest level random intercept equation. In doing so our
previous model becomes

#b.hregress C = const + X3   , family=gaussian_re equationtype=mu using dD#

#b.hregress C = X2(pspline) + D(hrandom)  , family=gaussian_re#

#equationtype=mu using dC#

#b.hregress y = X1(pspline)  + C(hrandom) , family=normal#
#equationtype=mu using d#



\subsection{Options}
\label{mcmcregregressoptions}

\vspace{0.4cm}

\subsubsection*{Options for controlling MCMC simulations}
\label{mcmc_options}

Options for controlling MCMC simulations are listed in
alphabetical order.

\begin{itemize}
\item #burnin = #{\em integer } \\
Changes the number of burn-in iterations to {\em integer}, where
{\em integer} must be a positive integer number or zero (i.e.~no
burn-in period).
The number of burn-in iterations must be smaller than the number of iterations (see option #iterations#).
Option #burnin# must be specified in the first equation of the model, otherwise the option will be ignored. \\
DEFAULT: #burnin=2000#

\item #iterations = #{\em integer } \\
Changes the number of MCMC iterations to {\em integer}, where {\em
integer} must be a positive integer number. The number of
iterations must be larger than the
number of burn-in iterations.
Option #iterations# must be specified in the first equation of the model, otherwise the option will be ignored. \\
DEFAULT: #iterations=52000 #

\item #step = #{\em integer} \\
Defines the thinning parameter for MCMC simulation. For example,
#step = 50# means, that every 50th sampled parameter will be
stored and used to compute characteristics of the posterior
distribution as means, standard deviations or quantiles. The aim
of thinning is to reach a considerable reduction of disk storing
and autocorrelations between sampled parameters.
Option #step# must be specified in the first equation of the model, otherwise the option will be ignored. \\
DEFAULT: #step=50#

\end{itemize}

\subsubsection*{Options for specifying the response distribution}

Options for specifying the response distribution are listed in
alphabetical order below.


\begin{itemize}
\item #aresp = #{\em realvalue } \\
Defines the value of the hyperparameter #a# for the inverse gamma
prior of the overall variance parameter $\sigma^2$, if the
response distribution is Gaussian with homoscedastic variance.
{\em realvalue} must be a positive real valued number. \\
DEFAULT: #aresp=1#

\item #bresp = #{\em realvalue } \\
Defines the value of the hyperparameter #b# for the inverse gamma
prior of the overall variance parameter $\sigma^2$, if the
response distribution is Gaussian with homoscedastic variance.
{\em realvalue} must be a positive real valued number. \\
DEFAULT: #bresp=0.005#
\item #equationtype = #{\em characterstring} \\
Defines the type of equation in the model, e.g. #equationtype=sigma2# and
 #equationtype=mu# for Gaussian responses. The admittable equation types depend on the response
 distribution family, see Tables \ref{tab:distrBayesX1}, \ref{tab:distrBayesX2}, \ref{tab:distrBayesX3}
and \ref{tab:distrBayesX4}. \\
DEFAULT: #equationtype=mu#
 \item #family = #{\em characterstring } \\
Defines the distribution of the response variable in the model.
Supported models can be found in Tables \ref{tab:distrBayesX1}, \ref{tab:distrBayesX2}, \ref{tab:distrBayesX3}
and \ref{tab:distrBayesX4}.
For some distributions
(e.g.~multinomial) additional options may be specified to control
MCMC inference.
A list of distributions with associated additional options is given in Table \ref{mcmcregfamilyadditionalopt}.  \\
A more detailed description on how to specify the
distribution of the response is given in \autoref{mcmcregfamilysyntax}. \\
DEFAULT: #family=normal#

\item #reference = #{\em realvalue} \\
Option #reference# is meaningful only if #family=multinom_probit# is
specified as the response distribution. In this case #reference#
defines the reference category to be chosen. Suppose, for
instance, that the response is three categorical with categories
1, 2 and 3. Then #reference=2# defines the value 2 to be the
reference category.
\end{itemize}

\begin{table}[ht]
\begin{center}
\begin{tabular} {|l|l|l|l|}
\hline
value of #family# & response distribution & link & additional options \\
\hline
#family=normal #           & Gaussian              & identity &  #aresp#, #bresp# \\
\hline
#family=multinom_probit#   & unordered multinomial & probit & #reference#\\
%#family=multinomial #        & unordered multinomial & logit & #reference#\\
\hline
\end{tabular}
{\em\caption {\label{mcmcregfamilyadditionalopt} Response distributions with additional options.}}
\end{center}
\end{table}

\subsubsection*{Further options} \label{further options}

Options are listed in alphabetical order:

\index{Credible intervals} \index{Credible intervals!Changing the
nominal level} \index{Changing the nominal level of credible
intervals}
\begin{itemize}
\item \label{level1} #level1 = #{\em integer} \\
Besides the posterior means and medians, {\em BayesX} provides
pointwise posterior credible intervals for every effect in the
model. In a Bayesian approach based on MCMC simulation techniques
credible intervals are estimated by computing the respective
quantiles of the sampled effects. By default, {\em BayesX}
computes pointwise as well as simultaneous credible intervals for nominal levels of 80\%
and 95\%. The option #level1# allows to redefine one of the
nominal levels (95\%). Adding, for instance,

#level1=99#

to the options list computes credible intervals for a nominal
level of 99\% rather than 95\%.
Option #level1# must be specified in the first equation of the model, otherwise the option will be ignored.
\item \label{level2} #level2 = #{\em integer} \\
Besides the posterior means and medians, {\em BayesX} provides
pointwise posterior credible intervals for every effect in the
model. In a Bayesian approach based on MCMC simulation techniques
credible intervals are estimated by computing the respective
quantiles of the sampled effects. By default, {\em BayesX}
computes pointwise as well as simultaneous credible intervals for nominal levels of 80\%
and 95 \%. The option #level2# allows to redefine one of the
nominal levels (80\%). Adding, for instance,

#level2=70#

to the options list computes credible intervals for a nominal
level of 70\% rather than 80\%.
Option #level2# must be specified in the first equation of the model, otherwise the option will be ignored.
\item \label{MCMCpredict} #predict# \\
\index{DIC} \index{Deviance}
\index{Deviance information criterion}
 \index{Predicted values}
Option #predict# may be specified to compute predicted values, samples of the deviance
$D$, the deviance
information criterion $DIC$, etc. The following specifications are possible:
\begin{itemize}
\item #predict=no# \\
This the default specification, i.e. predicted values are not computed.
\item #predict=full# \\
This specification computes and reports the model
deviance, the DIC, posterior means, medians, standard deviations and some quantiles of the
predictor, the estimated parameter and the expected value. The deviance and DIC
are reported in the regression output as well as in a file which ends with
``predict\_DIC.res''. The other results are stored in a file which ends with ``predict.res''.

Regarding the computation of the DIC and related quantities please take a look at page
\pageref{predict}.

\item #predict=fulls# \\
This specification provides the same output as #predict=full#. If method #getsample#
is applied after method #hregress# then #predict=fulls# provides an additional file (which ends with
``predict\_sample.raw'')
with all
samples of the computed quantities. Note that the size of the output file is huge even for very simple models
because the number of sampled quantities is proportional to the number of observations. Usually it is
not necessary to store all samples of the quantities obtained with #predict=full# or #predict=fulls#. Therefore
the specification #predict=full# is favorable compared to #predict=fulls#.

% \item #predict=light#
%\item #predict=predictor#

%\item #nosamples#
\end{itemize}

\end{itemize}



\subsection{Estimation output}

The way the estimation output is presented depends on the
estimated model. Estimation results of fixed effects are displayed
in a tabular form in the {\em output window} and/or in a log file
(if created before). Shown will be the posterior mean, the
standard deviation, the 2.5\% and the 97.5\% quantiles. Other
quantiles may be obtained by specifying the #level1# and/or
#level2# option, see \autoref{mcmcregregressoptions} for details.
Additionally a file is created where estimation results for fixed
effects are replicated. The name of the file is given in the {\em
output window} and/or in a log file.

Estimation effects of
nonlinear effects of continuous and spatial covariates as well as
unstructured random effects are presented in a different way.
Results are stored in an external ASCII-file whose contents can be
read into any general purpose statistics program (e.g.~STATA, R) to further analyze and/or visualize the results. The
structure of the files is as follows: There will be one file for
every (nonparametric) effect in the model. The name of the files and
the storing directory are displayed in the {\em output window}
and/or a log file. The files contain 17 or 18 columns
depending on whether the corresponding model term is an
interaction effect.
The first column contains an index
(starting with one), the second column (and the third column if
the estimated effect is an interaction effect) contain the
values of the covariate(s) whose effect is estimated. In the
following columns the estimation results are given in form of the
posterior means, standard deviations and the 2.5\%, 10\%, 50\%, 90\% and 97.5\%
pointwise credible intervals.
Other quantiles may be obtained by specifying the #level1# and/or
#level2# option, see \autoref{mcmcregregressoptions} for details.
The next  two columns contain posterior probabilities
based on nominal levels of 95\% and 80\%. A value of 1 corresponds
to a strictly positive 95\% or 80\% credible interval and a value
of -1 to a strictly negative credible interval. A value of 0
indicates that the corresponding credible interval contains zero.
The remaining 6 columns provide simultaneous credible intervals together
with their corresponding posterior probabilities. The simultaneous credible intervals
are computed according to a proposal by  \citeasnoun{krikne10}.

The estimated nonlinear effects can be visualized by using either
the graphics capabilities of {\em BayesX} or the {\it BayesX} R package, see \autoref{bayesxplot} and \autoref{rpackage},
respectively. Of course, any other (statistics) software package
with plotting facilities may be used as well.

\subsection{Examples}

Here we give only a few examples about the usage of method
#hregress#.
% More detailed examples can be found in chapter ?? of the tutorial manual.

Suppose that we have a data set #test# with a continuous response
variable #y#, and covariates  #x1#, #x2# and #x3#. Suppose further
that we have already created a {\em mcmcreg object} #b#.

\subsubsection{Single equation and parameter models}

We start by specifying Gaussian regression models for the response variable #y#
with homoscedastic variance $\sigma^2$, i.e. we define only a predictor for the mean
$\mu$ of the normal distribution.

\paragraph{Fixed effects}
$$$$
We first specify a model with
fixed effects for the covariates #x1#, #x2# and #x3#. Hence the
predictor for $\mu$ is

$$
\eta = \gamma_0 + \gamma_1 x1 + \gamma_2 x2 + \gamma_3 x3.
$$

This model is estimated by typing:

#> b.hregress y = const + x1 + x2 + x3, iterations=12000 burnin=2000# \\
#  step=10 family=normal using test#

Here, #step=10# defines the thinning parameter, i.e.~every
10th sampled parameter will be stored and used for estimation.
#test# is the data set that is used for estimation. By specifying
option #family=normal#, a Gaussian regression model is estimated.

\paragraph{Additive models}
$$$$
Suppose now that we want to allow for possibly nonlinear effects
of #x2# and #x3#. Assuming cubic P-splines with second order
random walk prior as smoothness priors, we obtain

#> b.hregress y = const + x1 + x2(pspline) + x3(pspline), iterations=12000 #\\
#  burnin=2000 step=10 family=normal using test#

which corresponds to the predictor
$$
\eta = \gamma_0 + \gamma_1 x1 + f_1(x2) + f_2(x3).
$$


\paragraph{Spatial covariates}
$$$$
Suppose now that we have an additional spatial covariate #region#,
which indicates the geographical region an observation belongs to.
To incorporate a structured spatial effect, we first have to
create a {\em map object} and read in the boundary information of
the different regions (polygons that form the regions, neighbors
etc.). If you are unfamiliar with {\em map objects} please read
\autoref{map} first.

#> map m# \\
#> m.infile using c:\maps\map.bnd#

In a second step we reorder the regions of the map using the
#reorder# command to obtain minimal bandwidths of the
corresponding adjacency matrix of the map. This usually speeds up
MCMC simulation for spatial effects.

#> m.reorder#

Since we normally need the map again in further sessions, we store
the reordered map in {\em graph file} format, because reading {\em
graph files} is much faster than reading {\em boundary files}.

#> m.outfile , graph using c:\maps\mapgraph.gra#

We can now extend our predictor with a spatial effect:

#> b.hregress y = const + x1 + x2(pspline) + x3(pspline) + # \\
#  region(spatial,map=m), iterations=12000 burnin=2000 #\\
#  step=10 family=normal using test#

In some situations it may be reasonable to incorporate  an
additional unstructured  random effect into the model in order to
split the total spatial effect into a structured and an
unstructured component. This is done by typing

#> b.hregress y = const + x1 + x2(psplinerw2) + x3(psplinerw2) + # \\
#   region(spatial,map=m) + region(random), iterations=12000 #\\
#  burnin=2000 step=10 family=normal using test#

\subsubsection{Multiple equation and parameter models}

We now add another equation for the variance of the Gaussian regression
model. We assume the same complex predictor for the mean and variance equation
as in the previous section and specify the two equations by:

#> b.hregress y = const + x1 + x2(psplinerw2) + x3(psplinerw2) + # \\
#   region(spatial,map=m) + region(random), iterations=12000 #\\
#  burnin=2000 step=10 family=normal equationtype=sigma2 using test#


#> b.hregress y = const + x1 + x2(psplinerw2) + x3(psplinerw2) + # \\
#   region(spatial,map=m) + region(random),  #\\
#  family=normal equationtype=mu using test#

Note that we additionally specify the option #equationtype# in both equations
in order to distinguish between the variance and mean equation.
Note also that MCMC specific details should only be specified in the first equation.
In fact, a possible specification in the second or following equations will be ignored.

In both equations we estimate region specific random effects and a smooth spatial effect. It is therefore
favorable to rewrite the model in multilevel form. This done using the following commands:


#> b.hregress region = const  + region2(spatial,map=m) , iterations=12000 # \\
#  burnin=2000 step=10 family=gaussian_re equationtype=sigma2 using regiondata# \\

#> b.hregress y =  x1 + x2(psplinerw2) + x3(psplinerw2) + region(hrandom), # \\
#  family=normal equationtype=sigma2 using test#


#> b.hregress region = const  + region2(spatial,map=m) ,  # \\
#   family=gaussian_re equationtype=mu using regiondata# \\


#> b.hregress y = const + x1 + x2(psplinerw2) + x3(psplinerw2) + # \\
#  region(hrandom),  family=normal equationtype=mu using test# \\

The model contains now two more equations for the random effects. We shifted the overall intercept into
the random effects equations to improve the mixing of MCMC samples, see \citeasnoun{LanUml14} for an explanation.
The smooth spatial effect is also contained in the random effects equations to improve mixing and speed up computations.

\section{Method autocor}
\label{mcmcautocorr} \index{mcmcreg object!Autocor command}



This method is a post estimation command, i.e.~its usage is
meaningful only if method #hregress# has been applied before. Method
#autocor# computes the autocorrelation functions of all sampled (and
stored) parameters.

The usage of method #autocor# is identical to its corresponding counterpart for {\em
bayesreg objects}, see section \ref{bayesautocorr} for details.


\section{Method getsample}
\label{mcmcgetsample} \index{mcmcreg object!Getsample command}
\index{Sampled parameters}


This method is a post estimation command, that is only meaningful if
method #hregress# has been applied before. With method #getsample#
all sampled parameters will be stored in (one or more) ASCII
file(s). Afterwards, sampling paths can be plotted and stored in a
postscript file either by using \hyperref[graphplotsample]{method
#plotsample#} of {\em graph objects} or by using the
\hyperref[rpackage]{R function #plotsample#}. Of
course, any other program with graphics capacities could be used as
well.

The usage of method #getsample# is identical to its corresponding counterpart for {\em
bayesreg objects}, see section \ref{bayesgetsample} for details.


\section{Global options}
\label{mcmcregglobopt} \index{mcmcreg object!Global options}

The purpose of global options is to affect the global behavior of
a {\em mcmcreg object}. The main characteristic of global options
is, that they are not associated with a certain method.

The syntax for specifying global options is

#> #{\em objectname}.{\em optionname} = {\em newvalue}

where {\em newvalue} is the new value of the option. The type of
the value depends on the respective option.

The following global options are currently available for {\em
mcmcreg objects}:

\begin{itemize}
\item #outfile = #{\em filename} \\
By default, the estimation output produced by the #hregress#
procedure will be written to the default output directory, which
is

{\em $<$INSTALLDIRECTORY$>$}#\output#.

The default filename is composed of the name of the {\em mcmcreg
object} and the type of the file. For example, if you estimated a
nonparametric effect for a covariate #X#, say, then the estimation
output will be written to

{\em$<$INSTALLDIRECTORY$>$}#\output\b_nonpX.res#

where #b# is the name of the {\em mcmcreg object}. In most cases,
however, it may be necessary to save estimation results into a
different directory and/or under a different filename than the
default. This can be done using the #outfile# option. With the
#outfile# option you have to specify the directory where the
output should be stored to and in addition a base filename. The
base filename should not be a complete filename. For example
specifying

#> b.outfile = c:\data\res#

would force {\em BayesX} to store the estimation result for the
nonparametric effect of #X# in file

#c:\data\res_nonpX.res#

\item #iterationsprint = #{\em integer}

By default, the current iteration number is printed in the {\em
output window} (or in an additional log file) after every 100th
iteration. This can lead to rather big and complex output files.
The #iterationsprint# option allows to redefine after how many
iterations the current iteration number is printed. For example
#iterationsprint=1000# forces {\em BayesX} to print the current
iterations number only after every 1000th iteration rather than
after every 100th iteration.
\end{itemize}

\section{Visualizing estimation results}

Visualization of estimation results is described in
\autoref{visualization}.
